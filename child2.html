<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Message Port Test - Child</title>
</head>
<body>
  <h2>Child Iframe</h2>
  <p>Open your browser's DevTools console to see messages.</p>

  <script>
    // Listen for messages from the parent
    window.addEventListener('message', (event) => {
      // Verify the message is from the same origin
      if (event.origin !== window.location.origin) {
        return;
      }
      console.log('Child received:', event.data);

      // Simulate an asynchronous operation before responding
      setTimeout(() => {
        // Try to respond after 2 seconds
        console.log('Child responding after delay: "Hello from child"');
        event.source.postMessage('Hello from child', event.origin);
      }, 2000);
    });
  </script>
</body>
</html>
